function TT = readOoiMinuteCsv(fn)
% Import data from text file
% Script for importing data from the following text file:
%
%    filename: /Users/takahiro/Dropbox/localcode/read3LSB/dat/ooi/hydro/ooi_min202507.csv
%
% Auto-generated by MATLAB on 07-Oct-2025 13:26:22
% fn = "~/Dropbox/localcode/read3LSB/dat/ooi/hydro/ooi_min202509.csv";
% Set up the Import Options and import the data
opts = delimitedTextImportOptions("NumVariables", 158);

% Specify range and delimiter
opts.DataLines = [4, Inf];
opts.Delimiter = ",";

% Specify column names and types
% Qhp2: 新大井発電放流
opts.VariableNames = [...
    "allDT", "Var2" , "Var3" , "Var4" , "Var5" , "Var6" , "wl"   , "Var8" , "Var9" , "rain",...
    "Var11", "Var12", "Var13", "Var14", "Qout" , "Var16", "Var17", "Qin"  , "Var19", "Var20",...
    "Var21", "Var22", "Var23", "Var24", "Qhp2" , "Var26", "Var27", "Var28", "Var29", "Var30",...
    "Var31", "Var32", "Var33", "Var34", "Var35", "Var36", "Var37", "Var38", "Var39", "Var40",...
    "Var41", "Var42", "Var43", "Var44", "Var45", "Var46", "Var47", "Var48", "Var49", "Var50",...
    "Var51", "Var52", "Var53", "Var54", "Var55", "Var56", "Var57", "Var58", "Var59", "Var60",...
    "Var61", "Var62", "Var63", "Var64", "Var65", "Var66", "Var67", "Var68", "Var69", "Var70",...
    "Var71", "Var72", "Var73", "Var74", "Var75", "Var76", "Var77", "Var78", "Var79", "Var80",...
    "Var81", "Var82", "Var83", "Var84", "Var85", "Var86", "Var87", "Var88", "Var89", "Var90",...
    "Var91", "Var92", "Var93", "Var94", "Var95", "Var96", "Var97", "Var98", "Var99", "Var100",...
    "Var101", "Var102", "Var103", "Var104", "Var105", "Var106", "Var107", "Var108", "Var109", "Var110",...
    "Var111", "Var112", "Var113", "Var114", "Var115", "Var116", "Var117", "Var118", "Var119", "Var120",...
    "Var121", "Var122", "Var123", "Var124", "Var125", "Var126", "Var127", "Var128", "Var129", "Var130",...
    "Var131", "Var132", "Var133", "Var134", "Var135", "Var136", "Var137", "Var138", "Var139", "Var140",...
    "Var141", "Var142", "Var143", "Var144", "Var145", "Var146", "Var147", "Var148", "Var149", "Var150",...
    "Var151", "Var152", "Var153", "Var154", "Var155", "Var156", "Var157", "Var158"];
opts.VariableTypes = [...
    "datetime"    "string"    "string"    "string"    "string" ...
    "string"      "double"    "string"    "string"    "double" ...
    "string"      "string"    "string"    "string"    "double" ...
    "string"      "string"    "double"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "double" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"    "string"    "string" ...
    "string"      "string"    "string"];

opts.SelectedVariableNames = ["allDT", "wl", "rain", "Qin", "Qout", "Qhp2"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";

% Specify variable properties
opts = setvaropts(opts, "allDT", "InputFormat", "yyyy/MM/dd/HH/mm", "DatetimeFormat", "preserveinput");

% Import the data
tt = readtable(fn, opts);


% Clear temporary variables
clear opts

TT = table2timetable(tt, 'RowTimes', 'allDT');
end